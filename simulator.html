<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
  background: #222;
  font-family: sans-serif;
  font-style: italic;
}

</style>
<body>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>

<script>

var spacetime = d3.select('body');
var width = $(window).width()
var height = $(window).height()

// Space
var svg = spacetime.append("svg")
  .attr("id","universe")
  .attr("width", width)
  .attr("height", height)
  .append("g")
    .attr("id","observedUniverse")
    .attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

$.getJSON( "/get_all_bodies", function( data ) {
  for (var i=0;i<data.length;i++){
    svg.append("circle")
      .attr("id",data[i].name)
      .attr("class",data[i].name)
      .attr("r", data[i].size)
      .attr("transform", "translate(" + - data[i].px + "," + - data[i].py + ")")
      .style("fill", data[i].color);
  }
});


setInterval(function () {
      $.getJSON( "/update_all_bodies/"+$(window).width()+"/"+$(window).height(), function( data ) {
        for (var i=0;i<data.length;i++){
          $("#"+data[i].name).attr("transform", "translate(" + - data[i].px + "," + - data[i].py + ")");
        }
      });
}, 32); // 30 fps = 32, 60 fps = 16
</script>

<script>
  $(window).resize(function() {
    var width = $(window).width();
    var height = $(window).height();

    $("#universe").attr("width",width);
    $("#universe").attr("height",height);

    $("#observedUniverse").attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");
  })
</script>
